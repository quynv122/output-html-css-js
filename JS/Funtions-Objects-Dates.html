<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Funtions - Objects - Dates</title>
  </head>
  <style>
    .bmi,
    .age {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .input-field {
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-top: 2rem;
    }
    .bmi-btn,
    .age-btn {
      margin: 2rem;
      background-color: bisque;
      padding: 10px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2),
        0 6px 20px 0 rgba(0, 0, 0, 0.19);
      cursor: pointer;
    }
    input {
      height: 2rem;
    }
  </style>
  <body>
    <section class="bmi">
      <form>
        <div class="input-field">
          <label for="height">Chiều Cao(cm)</label>
          <input type="number" id="height" name="height" placeholder="175" />
        </div>
        <div class="input-field">
          <label for="weight">Cân nặng(kg)</label>
          <input type="number" name="weight" id="weight" placeholder="60" />
        </div>
      </form>
      <div class="bmi-btn" id="bmi-btn">Tính BMI</div>
      <h2>Kết Quả: <span class="bmi-result"></span></h2>
    </section>
    <section class="age">
      <div class="input-field">
        <label for="age">Ngày Sinh</label>
        <input type="date" name="age" id="age" />
      </div>
      <div class="age-btn" id="age-btn">Tính tuổi</div>
      <h2>Kết Quả: <span class="age-result"></span></h2>
    </section>

    <script>
      document
        .getElementsByClassName("bmi-btn")[0]
        .addEventListener("click", () => {
          let weight = Number(document.getElementById("weight").value);
          let height = Number(document.getElementById("height").value);
          let result = document.getElementsByClassName("bmi-result")[0];
          if (isNaN(height) || height <= 0) {
            result.innerText = "Nhập chiều cao";
          } else if (isNaN(weight) || weight <= 0) {
            result.innerText = "Nhập cân nặng";
          } else {
            result.innerText = calculateBMI(height, weight);
          }
        });
      function calculateBMI(height, weight) {
        let bmi = weight / ((height / 100) * (height / 100));
        let result = "";
        if (bmi < 18.5) {
          result = "Gầy";
        } else if (bmi < 25) {
          result = "bình thường";
        } else {
          result = "Thừa cân";
        }
        return result;
      }

      document
        .getElementsByClassName("age-btn")[0]
        .addEventListener("click", () => {
          let input = document.getElementById("age").value;
          let result = document.getElementsByClassName("age-result")[0];

          if (!input) {
            result.innerText = "nhập ngày sinh";
            return;
          } else {
            result.innerText = `${getAge(input)} tuổi`;
          }
        });

      function getAge(date) {
        const birthday = new Date(date);
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        if (birthday >= today) {
          return "Nhập ngày hợp lệ";
        } else if (birthday.getFullYear() == today.getFullYear()) {
          let age = 0;
          return age;
        } else {
          let age = today.getFullYear() - birthday.getFullYear();

          if (today.getMonth() > birthday.getMonth()) {
            return age;
          } else if (today.getMonth() == birthday.getMonth()) {
            return birthday.getDate() > today.getDate() ? age - 1 : age;
          } else {
            return age - 1;
          }
        }
      }
      
    </script>
  </body>
</html>
